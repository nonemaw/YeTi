
{% extends "base.html" %}

{% block title %}YeTi OJ{% endblock %}

{% block head %}
    {{ super() }}
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/bootstrap-select.min.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='js/jstree/themes/proton/style.min.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/styles.css') }}">
{% endblock %}

{% block wide_content %}
    <div class="row" style="height: 94vh">
    <div id="progress"></div>
        <!-- left panel column -->
        <div class="col-md-4" style="height: 99%">

            <!-- search bar row -->
            <div class="row" style="margin-top: -9px">
                <div class="col-md-9">
                    <div class="input-group">
                        <input id="search-field" type="text" class="form-control" placeholder="Need something?">
                        <span class="input-group-btn">
                            <button id="search-button" class="btn btn-info" type="button">Search</button>
                        </span>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="row">
                        <button class="btn btn-danger" id="interface" data-toggle="modal" data-target=".interface-modal" style="float: right; width: 60%">Interface</button>
                    </div>
                </div>
            </div>
            <!-- end of search bar row -->

            <!-- interface modal view, display when click `Interface` button -->
            <div class="modal fade interface-modal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title" id="myModalLabel"><b>Interface</b><small>&nbsp;&nbsp;&nbsp;&nbsp;( Site {{ company }} )</small></h4>
                        </div>
                        <div class="modal-body">
                            <div class="row" style="height:100%;">
                                <div id="interface-tree-list" class="col-md-5" style="height:100%;overflow-y: auto">
                                    <div id="interface-tree">
                                        <ul class="jstree-container-ul jstree-children">
                                            <li role="treeitem" class="jstree-node jstree-leaf">
                                                <i class="jstree-icon jstree-ocl"></i>
                                                <a id="interface-temp" class="jstree-anchor" href="#"><i class="jstree-icon jstree-themeicon"></i>Loading ...</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div id="interface-window" class="col-md-7" style="height:100%">
                                    <h4 id="interface-note" style="font-weight: bold"></h4>
                                    <h4 id="interface-type" style="font-weight: bold; display: none">/</h4>
                                    <button id="interface-title" style="font-size: 18px; display: none">/</button>
                                    <!-- interface collection table1 for xplan collection items -->
                                    <div class="row" id="interface-table-row" style="height:250px">
                                        <div class="col-md-6" style="display:none;height:100%" id="interface-xplan-table1-head">
                                            <table class="table table-scroll left-column-table" style="height:100px">
                                                <thead>
                                                    <tr>
                                                        <th id="interface-xplan-table1-title"></th>
                                                    </tr>
                                                </thead>
                                                <tbody id="interface-xplan-table1" style="overflow-y: auto">
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="col-md-6" style="display:none;height:100%" id="interface-xplan-table2-head">
                                            <table class="table table-scroll left-column-table" style="height:100px">
                                                <thead>
                                                    <tr>
                                                        <th id="interface-xplan-table2-title"></th>
                                                    </tr>
                                                </thead>
                                                <tbody id="interface-xplan-table2" style="overflow-y: auto">
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="col-md-11" style="display:none;height:100%" id="interface-group-table-head">
                                            <table class="table table-scroll left-column-table" style="height:100px">
                                                <thead>
                                                    <tr>
                                                        <th id="interface-group-table-title"></th>
                                                    </tr>
                                                </thead>
                                                <tbody id="interface-group-table" style="overflow-y: auto">
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <br>
                                    <br>
                                    <h4 id="interface-entity" style="font-weight: bold; display: none">Applicable Entities</h4>
                                    <div class="checkbox" id="interface-individual" style="display: none">
                                        <label><input type="checkbox">&nbsp&nbspClient & Partner</label>
                                    </div>
                                    <div class="checkbox" id="interface-trust" style="display: none">
                                        <label><input type="checkbox">&nbsp&nbspTrust</label>
                                    </div>
                                    <div class="checkbox" id="interface-superfund" style="display: none">
                                        <label><input type="checkbox">&nbsp&nbspSuperfund</label>
                                    </div>
                                    <div class="checkbox" id="interface-company" style="display: none">
                                        <label><input type="checkbox">&nbsp&nbspCompany</label>
                                    </div>
                                    <div class="checkbox" id="interface-partnership" style="display: none">
                                        <label><input type="checkbox">&nbsp&nbspPartnership</label>
                                    </div>
                                    <br>
                                    <h4 id="interface-suggestion-title" style="font-weight: bold; display: none">/</h4>
                                    <p id="interface-suggestion-body" style="font-size: 16px; display: none">/</p>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- end of interface view -->

            <!-- choose variable row -->
            <div class="row" style="margin-top: -15px">
                <br>
                <div class="col-md-4 selection-field">
                    <div class="row">
                        <label for="syntax">Group</label>
                    </div>
                    <div class="row">
                        <select id="group-selector" class="selectpicker" data-size="20" data-width="100%" data-live-search="true"></select>
                    </div>
                </div>
                <div class="col-md-4 selection-field">
                    <div class="row">
                        <label for="syntax">Sub-Group</label>
                    </div>
                    <div class="row">
                        <select id="subgroup-selector" class="selectpicker" data-size="20" data-width="100%" data-live-search="true"></select>
                    </div>
                </div>
                <div class="col-md-4 selection-field">
                    <div class="row">
                        <label for="syntax">Variable</label>
                    </div>
                    <div class="row">
                        <select id="variable-selector" class="selectpicker" data-size="20" data-width="100%" data-live-search="true"></select>
                    </div>
                </div>
            </div>
            <!-- end of choose variable row -->

            <!-- variable information table row -->
            <div class="row" style="height: 32vh">
                <!-- Variable Table -->
                <div class="col-md-12" style="height: 100%">
                    <table class="table table-scroll left-column-table" style="height: 100%">
                        <tbody id="variable-selector-table" style="overflow-y: auto;">
                            <tr>
                                <td class="col-md-2" style="color: #009688"><b><i>Variable</i></b></td>
                                <td id="var-variable" class="col-md-10" style="font-family:Consolas">/</td>
                            </tr>
                            <tr>
                                <td class="col-md-2" style="color: #009688"><b><i>Usage</i></b></td>
                                <td id="var-usage" class="col-md-10" style="font-family:Consolas">/</td>
                            </tr>
                            <tr>
                                <td class="col-md-2" style="color: #009688"><b><i>Type</i></b></td>
                                <td id="var-type" class="col-md-10" style="font-family:Consolas">/</td>
                            </tr>
                            <tr>
                                <td id="choice-type" class="col-md-2" style="color: #009688"><b><i>Choice(s)</i></b></td>
                                <td class="col-md-10">

                                    <!-- Multi Choice list table -->
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th id="choice-value-title" class="col-md-5" style="color:#009688;font-style:italic;padding:2px">Value</th>
                                                <th id="choice-text-title" class="col-md-7" style="color:#009688;font-style:italic;padding:2px">Text</th>
                                            </tr>
                                        </thead>
                                        <tbody id="multi-choice-table">
                                            <tr>
                                                <td class="col-md-5" style="padding:2px;font-family:Consolas">/</td>
                                                <td class="col-md-7" style="padding:2px;">/</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <!-- end of multi choice list table -->

                                </td>
                            </tr>
                        </tbody>
                        <thead id="variable-search-table-head" style="display:none">
                            <tr>
                                <th id="choice-value-title" class="col-md-3" style="font-size:15px;padding:5px;"><i>Group</i></th>
                                <th id="choice-text-title" class="col-md-4" style="font-size:15px;padding:5px;"><i>Sub-Group</i></th>
                                <th id="choice-text-title" class="col-md-5" style="font-size:15px;padding:5px;"><i>Search Result</i></th>
                            </tr>
                        </thead>
                        <tbody id="variable-search-table" style="display:none; overflow-y: auto; height: 88%">
                            <tr><td class="col-md-3">/</td><td class="col-md-3">/</td><td class="col-md-6">/</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- end of variable information table -->

            <!-- pick snippet row -->
            <div class="row">
                <div class="row" style="padding-top: 8px">
                    <div class="col-md-5 selection-field">
                            <label for="syntax" style="font-size: 15px">Code Snippet Group</label>
                    </div>
                    <div class="col-md-5 selection-field">
                            <label for="syntax" style="font-size: 15px">Code Snippet Scenario</label>
                    </div>
                    <div class="col-md-2"></div>
                </div>
                <div class="row">
                    <div class="col-md-5 selection-field">
                        <select id="snippet-group-selector" class="selectpicker" data-size="15" data-width="100%" data-live-search="true">
                        </select>
                    </div>
                    <div class="col-md-5 selection-field">
                        <select id="snippet-scenario-selector" class="selectpicker" data-size="15" data-width="100%" data-live-search="true">

                        </select>
                    </div>
                    <div class="col-md-2">
                        <button class="btn btn-info" id="edit-snippet" style="width: 100%">Edit</button>
                    </div>
                </div>
            </div>
            <!-- end of pick snippet row -->

            <!-- snippet code editor row -->
            <div class="row" style="height: 43%">
                <div class="col-md-12" style="height: 100%">
                    <div class="row" style="height: 100%; padding-left: 15px">
                        <div id="snippet-section" style="height: 100%"></div>
                    </div>
                </div>
            </div>
            <!-- end of snippet code editor row -->
        </div>

        <!-- right column -->
        <div class="col-md-8" style="height: 99%">
            <div class="row" style="height: 100%">
                <div class="col-md-11" style="height: 100%">
                    <div id="code-section" style="height: 100%"></div>
                </div>
                <div class="col-md-1">
                    <div class="row">
                        <button class="btn btn-warning" id="judge" style="width: 85%">Judge</button>
                        <br>
                        <br>
                    </div>
                    <div class="row">
                        <label for="format-group">Format Code</label>
                        <button id="format" type="button" class="btn btn-success" style="width: 85%">Format</button>
                        <div class="btn-group-vertical" id="format-group" style="width: 85%">
                            <button id="indent" type="button" class="btn btn-success">Indent</button>
                            <button id="dedent" type="button" class="btn btn-success">Dedent</button>
                        </div>
                    </div>
                    <div class="row">
                        <label for="entity-group">Entity</label>
                        <div class="btn-group-vertical" id="entity-group" style="width: 85%">
                            <button id="client" type="button" class="btn btn-default">Client</button>
                            <button id="partner" type="button" class="btn btn-default">Partner</button>
                            <button id="joint" type="button" class="btn btn-default">Joint</button>
                        </div>
                        <div class="btn-group-vertical" id="entity-group" style="width: 85%">
                            <button id="trust" type="button" class="btn btn-default">Trust</button>
                            <button id="superfund" type="button" class="btn btn-default">Superfund</button>
                            <button id="company" type="button" class="btn btn-default">Company</button>
                            <button id="partnership" type="button" class="btn btn-default">Partnership</button>
                        </div>
                    </div>
                    <div class="row">
                        <br>
                        <button class="btn btn-danger" id="setting" data-toggle="modal" data-target=".bs-setting-modal-sm" style="width: 85%">Settings</button>
                    </div>

                    <!-- setting panel -->
                    <div class="modal fade bs-setting-modal-sm" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
                        <div class="modal-dialog modal-sm" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    <h4 class="modal-title" id="myModalLabel"><b>Editor Settings</b></h4>
                                </div>
                                <div class="modal-body">
                                    <div class="row">
                                        <div class="col-md-2"></div>
                                        <div class="col-md-10">
                                            <div class="row">
                                                <br>
                                                <label for="syntax">Syntax</label>
                                            </div>
                                            <div class="row">
                                                <select class="selectpicker" id="syntax" data-width="75%">
                                                    <option value="python" selected="selected">Python</option>
                                                    <option value="html">HTML</option>
                                                </select>
                                            </div>
                                            <div class="row">
                                                <label for="theme">Theme</label>
                                            </div>
                                            <div class="row">
                                                <select class="selectpicker" id="theme" data-width="75%">
                                                    <optgroup label="Bright">
                                                        <option value="github">GitHub</option>
                                                        <option value="solarized_light">Solarized Light</option>
                                                        <option value="xcode">XCode</option>
                                                    </optgroup>
                                                    <optgroup label="Dark">
                                                        <option value="chaos" selected="selected">Chaos</option>
                                                        <option value="monokai">Monokai</option>
                                                        <option value="pastel_on_dark">Pastel on Dark</option>
                                                        <option value="solarized_dark">Solarized Dark</option>
                                                    </optgroup>
                                                </select>

                                            </div>
                                            <div class="row">
                                                <label for="font-family">Font Family</label>
                                            </div>
                                            <div class="row">
                                                <select class="selectpicker" id="font-family" data-width="75%">
                                                    <option value="arial">Arial</option>
                                                    <option value="consolas" selected="selected">Consolas</option>
                                                    <option value="courier">Courier</option>
                                                </select>
                                            </div>
                                            <div class="row">
                                                <label for="font-size">Font Size</label>
                                            </div>
                                            <div class="row">
                                                <select class="selectpicker" id="font-size" data-width="75%">
                                                    <option>12</option>
                                                    <option>14</option>
                                                    <option>16</option>
                                                    <option>18</option>
                                                    <option selected="selected">20</option>
                                                    <option>22</option>
                                                    <option>24</option>
                                                    <option>28</option>
                                                    <option>34</option>
                                                    <option>40</option>
                                                </select>
                                            </div>
                                            <div class="row">
                                                <div class="checkbox">
                                                    <label><input id="show-invisibles" type="checkbox" value="" checked="checked">&nbsp&nbspShow Invisibles</label>
                                                </div>
                                                <div class="checkbox">
                                                    <label><input id="wrap-text" type="checkbox" value="" checked="checked">&nbsp&nbspWrap Text</label>
                                                </div>
                                                <div class="checkbox">
                                                    <label><input id="save-session" type="checkbox" value="">&nbsp&nbspSave Session & Setting</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- end of setting panel -->

                </div>
            </div>
        </div>
        <!-- end of right column -->

    </div>
{% endblock %}

{% block page_script %}
    <script src="//cdnjs.cloudflare.com/ajax/libs/nanobar/0.2.1/nanobar.min.js"></script>
    <script src="{{ url_for('static', filename='js/bootstrap-select.min.js') }}" type="text/javascript" charset="utf-8"></script>
    <script src="{{ url_for('static', filename='js/jstree/jstree.min.js') }}" type="text/javascript" charset="utf-8"></script>
    <script src="{{ url_for('static', filename='js/ace/ace.js') }}" type="text/javascript" charset="utf-8"></script>
    <script src="{{ url_for('static', filename='js/yeti/search_bar.js') }}" type="text/javascript" charset="utf-8"></script>
    <script src="{{ url_for('static', filename='js/yeti/initialize_group_subgroup_variable.js') }}" type="text/javascript" charset="utf-8"></script>
    <script src="{{ url_for('static', filename='js/yeti/initialize_code_snippet.js') }}" type="text/javascript" charset="utf-8"></script>
    <script src="{{ url_for('static', filename='js/yeti/initialize_interface.js') }}" type="text/javascript" charset="utf-8"></script>
    <script src="{{ url_for('static', filename='js/yeti/update_interface.js') }}" type="text/javascript" charset="utf-8"></script>
    <script>
        var save_session = true;
        var show_invisibles = true;
        var wrap_text = true;
        var initial_syntax = $('#syntax option:selected').val();
        var initial_theme = $('#theme option:selected').val();
        var initial_font_size = $('#font-size option:selected').val();
        var initial_font_family = $('#font-family option:selected').val();
        var code_section = ace.edit("code-section");
        var snippet_section = ace.edit("snippet-section");
        code_section.setTheme("ace/theme/" + initial_theme);
        code_section.session.setMode("ace/mode/" + initial_syntax);
        code_section.setOption("showInvisibles", show_invisibles);
        code_section.setOption("fontFamily", initial_font_family);
        code_section.setOption("fontSize", parseInt(initial_font_size));
        code_section.getSession().setUseWrapMode(wrap_text);
        code_section.setShowPrintMargin(false);
        snippet_section.setTheme("ace/theme/" + initial_theme);
        snippet_section.session.setMode("ace/mode/" + initial_syntax);
        snippet_section.setOption("showInvisibles", show_invisibles);
        snippet_section.setOption("fontFamily", initial_font_family);
        snippet_section.setOption("fontSize", 16);
        snippet_section.getSession().setUseWrapMode(true);
        snippet_section.setShowPrintMargin(false);
        // get selected code: code_section.getSelectedText()

        $('#subgroup-selector').prop('disabled', true);
        $('#variable-selector').prop('disabled', true);
        $('#snippet-scenario-selector').prop('disabled', true);

        $(document).ready(function() {

            function send_for_formatting(sent_info){
                $.ajax({
                    contentType: "application/json",
                    data: JSON.stringify(sent_info),
                    type: 'POST',
                    url: '/code/code_formatting',
                    dataType: 'json',
                    success: function(data, status, request) {
                        code_section.setValue(data.code);
                    },
                    error: function() {
                        alert('Unexpected error in sending code content');
                    }
                });
            }

            // right panel
            // judge button
            $('#judge').on('click', function(){
                var sent_info = {
                    message: 'judge',
                    code: code_section.getValue()
                };
                send_for_formatting(sent_info);
            });
            // indent button
            $('#indent').on('click', function(){
                var sent_info = {
                    message: 'indent',
                    code: code_section.getValue()
                };
                send_for_formatting(sent_info);
            });
            // dedent button
            $('#dedent').on('click', function(){
                var sent_info = {
                    message: 'dedent',
                    code: code_section.getValue()
                };
                send_for_formatting(sent_info);
            });
            // format button
            $('#format').on('click', function(){
                var sent_info = {
                    message: 'format',
                    code: code_section.getValue()
                };
                send_for_formatting(sent_info);
            });

            // client button
            $('#client').on('click', function(){
                var sent_info = {
                    message: 'client',
                    code: code_section.getValue()
                };
                send_for_formatting(sent_info);
            });
            // partner button
            $('#partner').on('click', function(){
                var sent_info = {
                    message: 'partner',
                    code: code_section.getValue()
                };
                send_for_formatting(sent_info);
            });
            // joint button
            $('#joint').on('click', function(){
                var sent_info = {
                    message: 'joint',
                    code: code_section.getValue()
                };
                send_for_formatting(sent_info);
            });
            // trust button
            $('#trust').on('click', function(){
                var sent_info = {
                    message: 'trust',
                    code: code_section.getValue()
                };
                send_for_formatting(sent_info);
            });
            // superfund button
            $('#superfund').on('click', function(){
                var sent_info = {
                    message: 'superfund',
                    code: code_section.getValue()
                };
                send_for_formatting(sent_info);
            });
            // company button
            $('#company').on('click', function(){
                var sent_info = {
                    message: 'company',
                    code: code_section.getValue()
                };
                send_for_formatting(sent_info);
            });
            // partnership button
            $('#partnership').on('click', function(){
                var sent_info = {
                    message: 'partnership',
                    code: code_section.getValue()
                };
                send_for_formatting(sent_info);
            });

            // syntax dropdown
            $('#syntax').on('change', function(){
                code_section.session.setMode("ace/mode/" + $('#syntax').val());
                snippet_section.session.setMode("ace/mode/" + $('#syntax').val());
            });
            // theme dropdown
            $('#theme').on('change', function(){
                code_section.setTheme("ace/theme/" + $('#theme').val());
                snippet_section.setTheme("ace/theme/" + $('#theme').val());
            });
            // font dropdown
            $('#font-family').on('change', function(){
                code_section.setOption("fontFamily", $('#font-family').val());
                snippet_section.setOption("fontFamily", $('#font-family').val());
            });
            // font size dropdown
            $('#font-size').on('change', function(){
                code_section.setOption("fontSize", parseInt($('#font-size').val()));
            });
            // show invisibles tick
            $('#show-invisibles').click(function() {
                show_invisibles = this.checked;
                if(show_invisibles) {
                    code_section.setOption("showInvisibles", true);
                    snippet_section.setOption("showInvisibles", true);
                }
                else {
                    code_section.setOption("showInvisibles", false);
                    snippet_section.setOption("showInvisibles", false);
                }
            });
            // wrap text tick
            $('#wrap-text').click(function() {
                wrap_text = this.checked;
                if(wrap_text) {
                    code_section.getSession().setUseWrapMode(wrap_text);
                }
                else {
                    code_section.getSession().setUseWrapMode(wrap_text);
                }
            });
            // save session tick
            $('#save-session').click(function() {
                save_session = this.checked;
                if(save_session) {
                    alert('session saved (test)')
                }
                else {
                    alert('save session unticked (test)')
                }
            });

            // display subgroup when select a group
            $('#group-selector').on('change', function(){
                $('#subgroup-selector').prop('disabled', false);
                $('#variable-selector').prop('disabled', false);
                var group_var = $('#group-selector option:selected').val();
                subgroup_initialization(group_var);
            });
            // display variable when select a subgroup
            $('#subgroup-selector').on('change', function(){
                var subgroup_id = $('#subgroup-selector option:selected').val();
                variable_initialization(subgroup_id, local_var_cache);
            });
            // update table when a variable is selected
            $('#variable-selector').on('change', function(){
                $('#variable-search-table').css('display', 'none');
                $('#variable-search-table-head').css('display', 'none');
                $('#variable-selector-table').css('display', '');
                var var_detail = local_var_cache[$('#variable-selector option:selected').val()];
                $('#var-variable').text($('#variable-selector option:selected').val());
                $('#var-usage').text(var_detail[0]);
                $('#var-type').text(var_detail[1]);
                var multi_choice_table = $('#multi-choice-table');
                multi_choice_table.empty();
                if (var_detail[2] && (Object.keys(var_detail[2]).length)) {
                    $('#choice-value-title').text('Value');
                    $('#choice-text-title').text('Text');
                    for (index in var_detail[2]) {
                        multi_choice_table.append('<tr><td class="col-md-5" style="font-family:Consolas">' + String(var_detail[2][index][0]) + '</td><td class="col-md-7">' + var_detail[2][index][1] + '</td></tr>');
                    }
                }
                else {
                    multi_choice_table.append('<tr><td class="col-md-5" style="font-family:Consolas">/</td><td class="col-md-7">/</td></tr>');
                }
            });
            // snippet group is selected
            $('#snippet-group-selector').on('change', function() {
                var group_id = $('#snippet-group-selector option:selected').val();
                if (group_id != '/') {
                    $('#snippet-scenario-selector').prop('disabled', false);
                    snippet_scenario_initialization(group_id);
                }
                else {
                    $('#snippet-scenario-selector').empty();
                    $('#snippet-scenario-selector').selectpicker('refresh');
                    $('#snippet-scenario-selector').prop('disabled', true);
                    snippet_section.setValue('');
                }
            });
            // snippet scenario is selected
            $('#snippet-scenario-selector').on('change', function() {
                snippet_section.setValue(local_scenario_cache[$('#snippet-scenario-selector').val()]);
            });
            // edit snippet button is clicked
            $('#edit-snippet').on('click', function() {
                var group_val =$('#snippet-group-selector').val();
                var scenario_val = $('#snippet-scenario-selector').val();
                if (group_val != '/' && group_val != null) {
                    location.replace('edit_snippet/' + group_val + '/' + scenario_val);
                }
            });

            // initialize interface menu view
            initialize_interface();

            // click on interface menu
            var selections = [];
            var local_leaf_cache = {};
            $('#interface-tree').on("select_node.jstree", function (e, data) {
                var id = data.node.id;
                var text = data.node.text;
                if (!selections.includes(id)) {
                    selections.push(id);
                    initialize_interface(id, text);
                }
            });
        });
    </script>
{% endblock %}
